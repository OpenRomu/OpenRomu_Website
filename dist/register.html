<html>
    <head>
        <link rel="stylesheet" href="./assets/styles.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
    </head>
    <body>
        <div class="app">
            <!-- LEFT MENU -->
            <div class="side-menu">
                <div class="side-header">
                    <span style="display: block; height: 80px;"></span>
                    <img src="./assets/FRFlag.png">
                    <span style="display: block; height: 40px;"></span>
                </div>
                <div class="side-section">
                    <h2 class="side-title">Téléchargement</h2>
                    <p class="version-text">
                        OpenRomu<br />
                        Version 1.0.0
                    </p>
                    <div class="download-container">
                        <a class="download-btn" href="https://drive.google.com/uc?export=download&id=1hr75ujQ73L-d8txw2DIBoaXyGYEgcdTP">
                                TELECHARGER
                        </a>
                    </div>
                    <p class="side-text" style="text-align: justify; text-justify: inter-word;">
                        <b>OpenRomu utilise le jeu de base Romustrike pour fonctionner. Réferez vous au tutoriel disponible dans la section "Comment Jouer"</b>
                    </p>
                </div>
                <div class="side-section">
                    <h2 class="side-title">Status du Serveur</h2>
                    <p class="side-text">
                        Serveur Maître: Up<br />
                        <br />
                        <a href="./register.html"><b>Créer un compte</b></a>
                    </p>
                </div>
                <div class="side-section">
                    <h2 class="side-title">Info</h2>
                    <p class="side-text">
                        Si vous souhaitez partager des <b>archives</b> ou informations avec OpenRomu,
                        Utilisez le <b>Discord</b> ou envoyez un mail à <a href="mailto:OpenRomu@gmail.com">OpenRomu@gmail.com</a>
                    </p>
                </div>
                <div class="side-section">
                    <h2 class="side-title">Partagez!</h2>
                    <p class="side-text">
                        Vous appréciez OpenRomu ?<br />
                        Parlez-en! Et la fréquentation augmentera.<br />
                    </p>
                </div>
            </div>
            <div class="layout-separator"></div>
            <!-- MAIN CONTAINER -->
            <div class="main-container">
                
<!-- NAVIGATION -->
<nav>
    <ul class="menu-container">
        <li class="menu-btn">
            <a class="menu-link" href="./index.html">Accueil</a>
        </li>
        <li class="menu-btn">
            <a class="menu-link" href="./howtoplay.html">Comment Jouer</a>
        </li>
        <li class="menu-btn">
            <a class="menu-link" href="./archives.html">Archives</a>
        </li>
        <!--<li class="menu-btn">
            <a class="menu-link" href="./scores.html">Scores</a>
        </li>-->
    </ul>
</nav>
                <div class="orange-line"></div>
                <!-- PAGE CONTENT -->
                <div id="content"><!-- PAGE CONTENT -->
<form>
  <h2>Créer un compte</h2>
  <label for="username"><b>Pseudo</b></label><br />
  <input id="username-input" type="text" placeholder="Pseudo" name="username" required><br />
  <br />
  <label for="email"><b>Email</b></label><br />
  <input id="email-input" type="text" placeholder="utilisateur@gmail.com" name="email" required><br />
  <br />
  <label for="password"><b>Mot de passe</b></label><br />
  <input id="password-input" type="password" placeholder="" name="password" required><br />
  <br />
  <label for="password-confirm"><b>Confirmez le mot de passe</b></label><br />
  <input id="password-confirm-input" type="password" placeholder="" name="password-confirm" required><br />
  <br />
  <p>En cliquant sur "s'enregistrer", vous acceptez sans conditions nos <a href="#" style="color:dodgerblue">termes & conditions d'utilisation</a>.</p>
  <button type="button" id="register-btn" onclick="register()">S'enregistrer</button>
</form>
<script>
  function register() {
    var notyf = new Notyf();
    var registerURI = 'https://localhost:27337/v1/players'

    // Username validation
    var username = document.getElementById('username-input').value
    if (username.length < 6) {
      notyf.error('Le nom d utilisateur doit faire 6 caractères au minimum')
      return
    }

    // Email validation
    var email = document.getElementById('email-input').value.toLowerCase()
    if (!email.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)) {
      notyf.error('L e-mail saisi semble invalide. Merci de respecter la forme identifiant@domain.tld')
      return
    }

    // Password validation
    var password = document.getElementById('password-input').value
    if (password.length < 6) {
      notyf.error('Le mot de passe doit faire 6 caractères au minimum')
      return
    }
    var passwordConfirm = document.getElementById('password-confirm-input').value
    if (password != passwordConfirm) {
      notyf.error('Le mot de passe et la confirmation ne sont pas identiques')
      return
    }

    // Register
    var registerBtn = document.getElementById("register-btn");
    registerBtn.disabled = true;
    try {
      fetch(registerURI, {
        mode: 'cors',
        method: 'POST',
        headers: {
          Accept: 'application.json',
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          username,
          email,
          password
        })
      }).then(response => {
        if (!response.ok) {
          notyf.error(`HTTP error! status: ${response.status}`)
          registerBtn.disabled = false;
        } else {
          notyf.success('Votre compte à été crée, vous pouvez jouer dès maintenant!')
          registerBtn.disabled = false;
          return response.json();
        }
      })
    } catch (e) {
      notyf.error(`Error! ${e}`)
      registerBtn.disabled = false;
    };
  }
</script></div>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
    </body>
</html>
